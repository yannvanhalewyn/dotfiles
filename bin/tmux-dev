#!/usr/bin/env bash
# https://ryan.himmelwright.net/post/scripting-tmux-workspaces/

# Either the first argument or the current directory name
session="${1:-$(basename $(pwd))}"

session_exists=$(tmux list-sessions | grep $session)

if [ "$session_exists" = "" ]
then
  echo "Creating new session"
  tmux new-session -d -s $session

  # Editor
  tmux rename-window -t 1 "nvim"
  tmux send-keys -t 1 "\$EDITOR" C-m

  # LazyJJ
  tmux new-window -t $session -n "VCS"
  tmux send-keys -t 2 "lazyjj" C-m

  # Devtools
  tmux new-window -t $session -n "Devtools"
  tmux split-window -t 3 -v -l 8

  # Shell
  tmux new-window -t $session -n "Shell"
else
  echo "Session already exists"
fi

# Attach to session's editor pane
echo "Attaching to session"
tmux -u attach-session -t $session:1
